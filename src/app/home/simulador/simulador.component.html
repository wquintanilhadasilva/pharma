<div class="jumbotron">

  <h1 class="display-4 text-center">Simulador de Margem</h1>

  <p class="lead text-center">Esta funcionalidade permite ajustar pedidos afetando a
    <mark>margem global</mark> do mês de referência.</p>

  <hr class="my-4">

  <p class="text-center">Apenas os pedidos <abbr title="Flag marcado durante a importação">marcados para essa análise</abbr> e aprovação serão exibidos
    aqui.
  </p>

  <div class="container-fluid">

    <div class="row">

      <div class="col-sm-12 col-md-6 margin-top-20">

        <div class=" card card-block min-height-200">

          <div class="form-group row">
            <label class="text-right text-primary col-6">Referência:</label>
            <h5 class="text-left text-info col-6">{{movimento.referencia}}</h5>
          </div>

          <div class="form-group row">
            <label class="text-right text-primary col-6">Total de Pedidos:</label>
            <h5 class="text-left text-info col-6">{{movimento.obtemTotalDePedidos() | number}}</h5>
          </div>

          <div class="form-group row">
            <label class="text-right text-primary col-6">Fat. Total:</label>
            <h5 class="text-left text-info col-6">{{ movimento.obtemFaturamentoTotal() | currency:'BRL':true }}</h5>
          </div>

        </div>

      </div>

      <div class="col-sm-12 col-md-6 margin-top-20">

        <div class="card card-block min-height-200">

          <div class="row">
            <div class="col-12">
              <h4 class="text-center text-primary">Margem Global</h4>
            </div>

          </div>

          <div class="row">
            <div class="col-12">
              <h2 class="display-3 text-success text-center">{{movimento.obtemMargemGlobal() | number:'3.2'}}</h2>
            </div>

          </div>

        </div>

      </div>

    </div>

    <!-- Tabela co mos pedidos -->

    <div class="row">

      <div class="col-12">

        <div class="card card-block margin-top-20">

          <h5 class="text-center text-primary">Pedidos a avaliar</h5>

          <div class="div-scrool">

            <table class=" table table-striped table-hover">
              <thead>
                <tr>
                  <th class="text-center td-order-item">Detalhes do pedido</th>
                  <th class="text-center td-order-item-action">Ações</th>
                </tr>
              </thead>
              <tbody>
                <tr class="tr-pedidos" *ngFor="let pedido of movimento.listaDePedidos">
                  <td class="td-order-item">
                    <div class=" row">
                      <div class="col-12">
                        <strong class="text-primary">{{pedido.customer | uppercase}}</strong><br/>
                        <h6><small>{{pedido.date | date:'dd/MM/yyyy'}}</small></h6>
                        <h5 class="text-success">{{pedido.getTotalOrder() | currency:'BRL':true }} <small class="text-danger">{{pedido.getMargin() | number:'3.2'}}%</small></h5>
                        <h5 class="text-danger"><small></small></h5>
                      </div>
                    </div>
                  </td>
                  <td class="td-order-item-action text-center">
                    <div class="row height-100">
                      <div class="col-12 vertical-center">
                        <i class="fa fa-check fa-2x" aria-hidden="true" (click)="pedidoSelecionado = pedido;" data-toggle="modal" data-target="#confirmarAprovacao"></i>
                        <i class="fa fa-times fa-2x" aria-hidden="true" (click)="pedidoSelecionado = pedido;" data-toggle="modal" data-target="#confirmarExclusao"></i>
                        <i class="fa fa-pencil fa-2x" aria-hidden="true"></i>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>

          </div>

        </div>

      </div>

    </div>

  </div>

</div>

<!-- Modal Exclusão-->
<div class="modal fade" id="confirmarExclusao" tabindex="-1" role="dialog" aria-labelledby="confirmarExclusaoTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confirmarExclusaoTitle">Confirmar Rejeição</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="lead text-center">Tem certeza que deseja
            <mark><strong class=" text-danger text-primary">Rejeitar</strong></mark> esse pedido?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="pedidoSelecionado = null;" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="rejeitarPedido();pedidoSelecionado = null" data-dismiss="modal">Confirmar</button>
      </div>
    </div>
  </div>
</div>



<!-- Modal Aprovação -->
<div class="modal fade" id="confirmarAprovacao" tabindex="-1" role="dialog" aria-labelledby="confirmarAprovacaoTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confirmarAprovacaoTitle">Confirmar Aprovação</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="lead text-center">Tem certeza que deseja
            <mark><strong class=" text-success text-primary">Aprovar</strong></mark> esse pedido?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="pedidoSelecionado = null;" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary" (click)="aprovarPedido();pedidoSelecionado = null;" data-dismiss="modal">Confirmar</button>
      </div>
    </div>
  </div>
</div>
